<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="普通程序员的博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="普通程序员的博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="普通程序员的博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title> 普通程序员的博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">普通程序员的博客</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">以中有足乐者,不知口体之奉不若人也.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/27/offsetTop获取父子元素的高度差/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="辣鸡Coder">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="普通程序员的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="普通程序员的博客" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/12/27/offsetTop获取父子元素的高度差/" itemprop="url">
                  offsetTop获取父子元素的高度差
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-27T22:54:17+08:00">
                2017-12-27
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          
             <span id="/2017/12/27/offsetTop获取父子元素的高度差/" class="leancloud_visitors" data-flag-title="offsetTop获取父子元素的高度差">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="offsetTop获取父子元素高度差"><a href="#offsetTop获取父子元素高度差" class="headerlink" title="offsetTop获取父子元素高度差"></a>offsetTop获取父子元素高度差</h1><blockquote>
<p>偶然发现可以用这种方式获取正确的高度差</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"photo-wrap full-width"</span> <span class="attr">style</span>=<span class="string">"height: 511.94px;"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"camera-sample"</span> <span class="attr">id</span>=<span class="string">"J_cameraSample"</span> <span class="attr">src</span>=<span class="string">"./example.png"</span> &gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>使用<code>flex</code>布局，并让其中的元素垂直居中。</p>
<p>通过获取子元素的<code>offsetTop</code>就能得到高度差的一半。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.photo-wrap</span> &#123;</div><div class="line">  <span class="attribute">position</span>: relative;</div><div class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</div><div class="line">  <span class="attribute">display</span>: flex;</div><div class="line">  <span class="attribute">align-items</span>: center;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.camera-sample</span> &#123;</div><div class="line">  <span class="attribute">vertical-align</span>: bottom;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-tag">img</span> &#123;</div><div class="line">  <span class="attribute">border</span>: <span class="number">0</span> none;</div><div class="line">  <span class="attribute">vertical-align</span>: middle;</div><div class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> cameraSample = <span class="built_in">document</span>.querySelector(<span class="string">'#J_cameraSample'</span>)</div><div class="line"><span class="built_in">console</span>.log(cameraSample.offsetTop,<span class="string">'offsetTop'</span>);</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/09/记uglify压缩出错的解决办法/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="辣鸡Coder">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="普通程序员的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="普通程序员的博客" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/09/记uglify压缩出错的解决办法/" itemprop="url">
                  记uglify压缩出错的解决办法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-09T16:49:11+08:00">
                2017-04-09
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          
             <span id="/2017/04/09/记uglify压缩出错的解决办法/" class="leancloud_visitors" data-flag-title="记uglify压缩出错的解决办法">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>上个月做的一个微信端的项目，准备部署到服务器上的时候gulp-uglify报错。</p>
</blockquote>
<p>公司用的是同一个框架，其他项目可以正常uglify，就说明是自己写的代码有问题，具体哪里有问题，不知道～gulp的错误信息也没什么卵用。</p>
<h5 id="获取更详细的错误信息"><a href="#获取更详细的错误信息" class="headerlink" title="获取更详细的错误信息"></a>获取更详细的错误信息</h5><ol>
<li>安装<code>gulp-util</code>插件</li>
<li>监听uglify()的错误事件</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gutil = <span class="built_in">require</span>(<span class="string">'gulp-util'</span>);</div><div class="line">gulp.task(<span class="string">'scripts'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    gulp.src(config.paths.scripts)</div><div class="line">        <span class="comment">// .pipe(uglify())</span></div><div class="line">        .pipe(uglify().on(<span class="string">'error'</span>, gutil.log));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>这样uglify错误的时候会输出更详细的错误信息，告诉你那个文件那个位置等..接下来就能顺利解决问题了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/31/ion-infinite-scroll在Android的坑/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="辣鸡Coder">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="普通程序员的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="普通程序员的博客" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/31/ion-infinite-scroll在Android的坑/" itemprop="url">
                  ion-infinite-scroll在Android的坑
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-31T22:12:36+08:00">
                2017-03-31
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          
             <span id="/2017/03/31/ion-infinite-scroll在Android的坑/" class="leancloud_visitors" data-flag-title="ion-infinite-scroll在Android的坑">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>临时被安排需要做一个IOS端内嵌的H5页面模板，同时也需要在微信端能使用。下午本已实现，谁料临近下班的时候测试提出二次分享链接后，页面无法在微信端正常显示，白花花的一片。</p>
<h3 id="定位问题"><a href="#定位问题" class="headerlink" title="定位问题"></a>定位问题</h3><p>将二次分享的链接单独打开来，在自己的6sp上一切正常。</p>
<p>由于同事的是安卓系统，遂拿来测试安卓机，同样无法显示，定位问题为安卓系统下页面渲染的问题，排除分享链接所致。</p>
<p>微信开发者工具没有报错信息，查看DOM发现均没有满足<code>ng-if</code>的条件；怀疑没有执行方法，从服务器获取数据。</p>
<p>controller中手动执行初始化方法后，Android端能够正常显示，IOS端正常显示；由于初始化方法和<code>on-infinite=&quot;&quot;</code>方法为同一个，手动调用一次后在IOS下<code>ion-infinite-scroll</code>会再次自动调用init方法。那么问题就能解决了。</p>
<h3 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h3><p>使用<code>ionic.Platform.platform()</code>判断用户所使用的设备信息，如果不为IOS则手动执行init方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (ionic.Platform.platform() !== <span class="string">'ios'</span>) &#123;</div><div class="line">	init();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h3><p>在之后一次偶然的发现，<code>android</code>下的<code>ion-infinite-scroll</code>容器的<code>div</code>会占据整个屏幕，同时我又给<code>ion-infinite-scroll</code>设置了一个<strong>20px</strong>的<code>margin-top</code>。导致<code>ion-infinite-scroll</code>没有满足不足底部1%的触发的条件，从而无法自动加载。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/20/解决Charles4-0-2抓取Https请求乱码/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="辣鸡Coder">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="普通程序员的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="普通程序员的博客" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/02/20/解决Charles4-0-2抓取Https请求乱码/" itemprop="url">
                  解决Charles4.0.2抓取Https请求乱码
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-20T20:23:32+08:00">
                2017-02-20
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          
             <span id="/2017/02/20/解决Charles4-0-2抓取Https请求乱码/" class="leancloud_visitors" data-flag-title="解决Charles4.0.2抓取Https请求乱码">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>由于最近在写一个小应用，需要抓点API省的自己造数据。于是就用了Charles4.0.2想试着抓点数据，结果就是各种乱码～。<br>Google了一下全是3.x版本的办法，最后发现需要手动添加白名单来抓取https，我们只要把白名单设置成通配就能直接抓取https而不乱码了。</p>
<hr>
<p>Proxy -&gt; SSL Proxying Setting 然后添加白名单即可<br><img src="/2017/02/20/解决Charles4-0-2抓取Https请求乱码/img.png" alt="img.png" title=""></p>
<p>另外如果还不行的话就在Help -&gt; SSL Proxying -&gt; Install Charles Root Certificate 把证书装一下，因为证书我是在添加白名单之前加的，所以不知道有没有影响。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/16/1-x初窥/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="辣鸡Coder">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="普通程序员的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="普通程序员的博客" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/02/16/1-x初窥/" itemprop="url">
                  angularjs_1.x初窥
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-16T21:38:23+08:00">
                2017-02-16
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          
             <span id="/2017/02/16/1-x初窥/" class="leancloud_visitors" data-flag-title="angularjs_1.x初窥">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="AngularJs-1-x-窥探"><a href="#AngularJs-1-x-窥探" class="headerlink" title="AngularJs 1.x 窥探"></a>AngularJs 1.x 窥探</h1><blockquote>
<p>根据AngularJs 1.x<a href="https://docs.angularjs.org/tutorial" target="_blank" rel="external">官方教程</a>整理笔记（step0-step8）</p>
</blockquote>
<h2 id="ng-app标志"><a href="#ng-app标志" class="headerlink" title="ng-app标志"></a>ng-app标志</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"phoneApp"</span>&gt;</span></div></pre></td></tr></table></figure>
<p>申明整个html都是angular的作用域，同时也可以在局部进行申明。例如<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-app</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="Angular-Templates"><a href="#Angular-Templates" class="headerlink" title="Angular Templates"></a>Angular Templates</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 定义一个phonecatApp的实例，与ng-app作用域进行绑定</span></div><div class="line"><span class="keyword">var</span> phonecatApp = angular.module(<span class="string">'phonecatApp'</span>, []);</div><div class="line"></div><div class="line"><span class="comment">// Define the `PhoneListController` controller on the `phonecatApp` module</span></div><div class="line">phonecatApp.controller(<span class="string">'PhoneListController'</span>, <span class="function"><span class="keyword">function</span> <span class="title">PhoneListController</span>(<span class="params">$scope</span>) </span>&#123;</div><div class="line"><span class="comment">// 绑定在$scope上的变量可以直接被模版获取</span></div><div class="line">  $scope.phones = [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'Nexus S'</span>,</div><div class="line">      <span class="attr">snippet</span>: <span class="string">'Fast just got faster with Nexus S.'</span></div><div class="line">    &#125;, &#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'Motorola XOOM™ with Wi-Fi'</span>,</div><div class="line">      <span class="attr">snippet</span>: <span class="string">'The Next, Next Generation tablet.'</span></div><div class="line">    &#125;, &#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'MOTOROLA XOOM™'</span>,</div><div class="line">      <span class="attr">snippet</span>: <span class="string">'The Next, Next Generation tablet.'</span></div><div class="line">    &#125;</div><div class="line">  ];</div><div class="line">  $scope.name = <span class="string">'joke'</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="Component"><a href="#Component" class="headerlink" title="Component"></a>Component</h2><h3 id="1-x"><a href="#1-x" class="headerlink" title="1.x"></a>1.x</h3><h4 id="定义一个component"><a href="#定义一个component" class="headerlink" title="定义一个component"></a>定义一个component</h4><p>新建一个phone-list.component.js从而定义一个component</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">angular.</div><div class="line"><span class="comment">//phonecatApp为ng-app定义的作用域名</span></div><div class="line">  <span class="built_in">module</span>(<span class="string">'phonecatApp'</span>).</div><div class="line">  <span class="comment">//phoneList为模板的名称，使用方法&lt;phone-list&gt;&lt;/phone-list&gt;</span></div><div class="line">  component(<span class="string">'phoneList'</span>, &#123;</div><div class="line">  <span class="comment">//模板内容，渲染HTML</span></div><div class="line">    template:</div><div class="line">        <span class="string">'&lt;ul&gt;'</span> +</div><div class="line">          <span class="string">'&lt;li ng-repeat="phone in $ctrl.phones"&gt;'</span> +<span class="comment">//$ctrl为模板默认的控制器</span></div><div class="line">            <span class="string">'&lt;span&gt;&#123;&#123;phone.name&#125;&#125;&lt;/span&gt;'</span> +</div><div class="line">            <span class="string">'&lt;p&gt;&#123;&#123;phone.snippet&#125;&#125;&lt;/p&gt;'</span> +</div><div class="line">          <span class="string">'&lt;/li&gt;'</span> +</div><div class="line">        <span class="string">'&lt;/ul&gt;'</span>,</div><div class="line">        <span class="comment">//控制器内容</span></div><div class="line">    controller: <span class="function"><span class="keyword">function</span> <span class="title">PhoneListController</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//this指代当前控制器</span></div><div class="line">      <span class="keyword">this</span>.phones = [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">name</span>: <span class="string">'Nexus S'</span>,</div><div class="line">          <span class="attr">snippet</span>: <span class="string">'Fast just got faster with Nexus S.'</span></div><div class="line">        &#125;, &#123;</div><div class="line">          <span class="attr">name</span>: <span class="string">'Motorola XOOM™ with Wi-Fi'</span>,</div><div class="line">          <span class="attr">snippet</span>: <span class="string">'The Next, Next Generation tablet.'</span></div><div class="line">        &#125;, &#123;</div><div class="line">          <span class="attr">name</span>: <span class="string">'MOTOROLA XOOM™'</span>,</div><div class="line">          <span class="attr">snippet</span>: <span class="string">'The Next, Next Generation tablet.'</span></div><div class="line">        &#125;</div><div class="line">      ];</div><div class="line">    &#125;</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><p>app.js实例ng-app定义的model</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">'phonecatApp'</span>,[])</div></pre></td></tr></table></figure>
<p>HTML文件中引用template</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;phone-list&gt;<span class="xml"><span class="tag">&lt;/<span class="name">phone-list</span>&gt;</span></span></div></pre></td></tr></table></figure>
<h3 id="2-x版本"><a href="#2-x版本" class="headerlink" title="2.x版本"></a>2.x版本</h3><p>@Component定义一个组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</div><div class="line"></div><div class="line">@Component(&#123;</div><div class="line">  <span class="attr">selector</span>: <span class="string">'my-app'</span>, <span class="comment">//组件的名称，被外部调用；</span></div><div class="line">  template:<span class="string">`</span></div><div class="line">    &lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;</div><div class="line">  `</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>单个组件中的数据模型，template中的数据从AppComponent类中获取</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppComponent</span> </span>&#123;</div><div class="line">  title = <span class="string">'Tour XXXX'</span>;</div><div class="line">  myHero = <span class="string">'xxx'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="文件组织和目录"><a href="#文件组织和目录" class="headerlink" title="文件组织和目录"></a>文件组织和目录</h3><p>为了让整个项目更加的清晰、方便后期的维护。我们不应该将所有的component写在一个文件中，所有的controller写在一个文件中，一个文件应该纯粹的只实现一个功能。并按照component的结构目录进行分类。如此一来，创建component的方式也会发生变化，不再将template和controller写在一个文件中，也不会绑定在同一module上。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//phone-list.component.js</span></div><div class="line">angular.</div><div class="line">  module(<span class="string">'phoneList'</span>).<span class="comment">//绑定的是phone-list.module.js 中的实例</span></div><div class="line">  component(<span class="string">'phoneList'</span>, &#123;</div><div class="line">    <span class="attr">templateUrl</span>: <span class="string">'phone-list/phone-list.template.html'</span>,<span class="comment">//引用外部的HTML作为模板</span></div><div class="line">    controller: <span class="function"><span class="keyword">function</span> <span class="title">PhoneListController</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">this</span>.phones = [....];</div><div class="line">    &#125;</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//phone-list.module.js</span></div><div class="line">angular.module(<span class="string">'phoneList'</span>, []);</div><div class="line"></div><div class="line"><span class="comment">//在app.module.js中将phoneList添加到ng-app定义的module中</span></div><div class="line"><span class="comment">// Define the `phonecatApp` module</span></div><div class="line">angular.module(<span class="string">'phonecatApp'</span>, [</div><div class="line">  <span class="comment">// ...which depends on the `phoneList` module</span></div><div class="line">  <span class="string">'phoneList'</span></div><div class="line">]);</div></pre></td></tr></table></figure>
<p>结构目录大致如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">app/</div><div class="line">  phone-list/</div><div class="line">    phone-list.module.js</div><div class="line">    phone-list.component.js</div><div class="line">    phone-list.component.spec.js</div><div class="line">  app.module.js</div></pre></td></tr></table></figure>
<h2 id="迭代过滤器"><a href="#迭代过滤器" class="headerlink" title="迭代过滤器"></a>迭代过滤器</h2><p>通过ng-model双向绑定控制器中的数据并使用filter过滤</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-md-2"</span>&gt;</div><div class="line"> <span class="xml"><span class="comment">&lt;!--Sidebar content--&gt;</span></span></div><div class="line"> //双向绑定</div><div class="line"> Search: <span class="tag">&lt;<span class="name">input</span> <span class="attr">ng-model</span>=<span class="string">"$ctrl.query"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-10"</span>&gt;</span></div><div class="line"> <span class="comment">&lt;!--Body content--&gt;</span></div><div class="line"> <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"phones"</span>&gt;</span></div><div class="line"> //根据$ctrl.query迭代过滤</div><div class="line"> // orderBy: $ctrl.age 排序</div><div class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">ng-repeat</span>=<span class="string">"phone in $ctrl.phones | filter:$ctrl.query"</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;phone.name&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;phone.snippet&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">   <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"> <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="双向绑定"><a href="#双向绑定" class="headerlink" title="双向绑定"></a>双向绑定</h2><h3 id="angular-1-x"><a href="#angular-1-x" class="headerlink" title="angular 1.x"></a>angular 1.x</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ng-model=<span class="string">"$ctrl.query"</span> </div><div class="line"><span class="comment">//ng-model = "valueModel"双向绑定 可由&#123;&#123;valueModel || '默认值'&#125;&#125;直接引用</span></div></pre></td></tr></table></figure>
<h3 id="AngularJs-2"><a href="#AngularJs-2" class="headerlink" title="AngularJs 2"></a>AngularJs 2</h3><p>app.module.ts 中引入 FormsModule,并添加至imports数组中<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">@NgModule(&#123;</div><div class="line">  <span class="attr">imports</span>: [</div><div class="line">    BrowserModule,</div><div class="line">    FormsModule</div><div class="line">  ],</div><div class="line"> .....</div></pre></td></tr></table></figure></p>
<p>然后通过[(ngModel)]=”变量名”进行绑定<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;FormsModule&#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span></div></pre></td></tr></table></figure></p>
<h2 id="XHR和依赖注入"><a href="#XHR和依赖注入" class="headerlink" title="XHR和依赖注入"></a>XHR和依赖注入</h2><p>通过$http内建服务向你的Web服务器发起请求，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">controller: <span class="function"><span class="keyword">function</span> <span class="title">PhoneListController</span>(<span class="params">$http</span>) </span>&#123;</div><div class="line"> <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line"> self.orderProp = <span class="string">'age'</span>;</div><div class="line"><span class="comment">//$http返回一个promise对象</span></div><div class="line"> $http.get(<span class="string">'phones/phones.json'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</div><div class="line">   self.phones = response.data;</div><div class="line"> &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面的方法定义控制器在压缩JS后将无法正常工作，可以采用以下的方式<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">controller: [<span class="string">'$http'</span>,</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">PhoneListController</span>(<span class="params">$http</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">    self.orderProp = <span class="string">'age'</span>;</div><div class="line"></div><div class="line">    $http.get(<span class="string">'phones/phones.json'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</div><div class="line">      self.phones = response.data;</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure></p>
<h2 id="通过ng-src添加图片"><a href="#通过ng-src添加图片" class="headerlink" title="通过ng-src添加图片"></a>通过ng-src添加图片</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">ng-src</span>=<span class="string">"&#123;&#123;phone.src&#125;&#125;"</span>&gt;</span> <span class="comment">&lt;!--设置图片，由Angular来对其进行解析--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#/xx/&#123;&#123;&#125;&#125;"</span>&gt;</span> <span class="comment">&lt;!--在href中也可以通过双大括号的语法将其正确解析--&gt;</span></div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/14/Webpack学习笔记二/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="辣鸡Coder">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="普通程序员的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="普通程序员的博客" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/14/Webpack学习笔记二/" itemprop="url">
                  Webpack学习笔记二
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-14T11:21:11+08:00">
                2017-01-14
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          
             <span id="/2017/01/14/Webpack学习笔记二/" class="leancloud_visitors" data-flag-title="Webpack学习笔记二">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这是学习Webpack的下一篇笔记，上一篇<a href="https://jsdtt.github.io/2017/01/13/Webpack%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80/" target="_blank" rel="external">webpack学习笔记一</a>.</p>
<h3 id="Common-chunk"><a href="#Common-chunk" class="headerlink" title="Common chunk"></a>Common chunk</h3><p>当多个script文件用着公共的函数块时，你能使用CommonsChunkPlugin将公共部分编译成为一个单独的文件。<br>省略了html和js..<br>webpack.config.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> CommonsChunkPlugin = <span class="built_in">require</span>(<span class="string">"webpack/lib/optimize/CommonsChunkPlugin"</span>);</div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: &#123;</div><div class="line">    <span class="attr">bundle1</span>: <span class="string">'./main1.jsx'</span>,</div><div class="line">    <span class="attr">bundle2</span>: <span class="string">'./main2.jsx'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'[name].js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">loaders</span>:[</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.js[x]?$/</span>,</div><div class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</div><div class="line">        <span class="attr">loader</span>: <span class="string">'babel-loader'</span>,</div><div class="line">        <span class="attr">query</span>: &#123;</div><div class="line">          <span class="attr">presets</span>: [<span class="string">'es2015'</span>, <span class="string">'react'</span>]</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: [</div><div class="line">    <span class="keyword">new</span> CommonsChunkPlugin(<span class="string">'init.js'</span>)</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>通过webpack编译打包后会生成一个init.js的公共部分</p>
<h3 id="Vendor-chunk"><a href="#Vendor-chunk" class="headerlink" title="Vendor chunk"></a>Vendor chunk</h3><p>不知道Vendor chunk应该翻译成什么，大意应该就是第三方library函数块。<br>通过CommonsChunkPlugin能够将第三方的library导出为一个单独的文件，从而让编译后的js在开发的时候更加清晰<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> $ = <span class="built_in">require</span>(<span class="string">'jquery'</span>)</div><div class="line">$.(<span class="string">'h1'</span>).text(<span class="string">'Hello World'</span>)</div></pre></td></tr></table></figure></p>
<p>//省略html，在html中要引入分割出来的第三方library，如vendor.js<br>webpack.config.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: &#123;</div><div class="line">    <span class="attr">app</span>: <span class="string">'./main.js'</span>,</div><div class="line">    <span class="attr">vendor</span>: [<span class="string">'jquery'</span>],</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: [</div><div class="line">    <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(<span class="comment">/* chunkName= */</span><span class="string">'vendor'</span>, <span class="comment">/* filename= */</span><span class="string">'vendor.js'</span>)</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>如果你想让一个模块能够被其他任何模块所得到，例如$和jQuery。你除了需要require(“jquery”)之外还应该使用<a href="http://webpack.github.io/docs/shimming-modules.html" target="_blank" rel="external">ProvidePlugin</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// main.js</span></div><div class="line">$(<span class="string">'h1'</span>).text(<span class="string">'Hello World'</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// webpack.config.js</span></div><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: &#123;</div><div class="line">    <span class="attr">app</span>: <span class="string">'./main.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: [</div><div class="line">    <span class="keyword">new</span> webpack.ProvidePlugin(&#123;</div><div class="line">      <span class="attr">$</span>: <span class="string">"jquery"</span>,</div><div class="line">      <span class="attr">jQuery</span>: <span class="string">"jquery"</span>,</div><div class="line">      <span class="string">"window.jQuery"</span>: <span class="string">"jquery"</span></div><div class="line">    &#125;)</div><div class="line">  ]</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h3 id="Exposing-global-variables"><a href="#Exposing-global-variables" class="headerlink" title="Exposing global variables"></a>Exposing global variables</h3><p>如果你想使用一些全局变量，但是不想这些变量在bundle的时候包括在里面。你可以开启在webpack的配置文件中开启externals.<a href="http://webpack.github.io/docs/library-and-externals.html" target="_blank" rel="external">文档</a><br>例如你有一个data.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> data = <span class="string">"Hello"</span></div></pre></td></tr></table></figure></p>
<p>我们能够将data暴露出来，成为全局变量<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'./main.jsx'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">loaders</span>:[</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.js[x]?$/</span>,</div><div class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</div><div class="line">        <span class="attr">loader</span>: <span class="string">'babel-loader'</span>,</div><div class="line">        <span class="attr">query</span>: &#123;</div><div class="line">          <span class="attr">presets</span>: [<span class="string">'es2015'</span>, <span class="string">'react'</span>]</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">externals</span>: &#123;</div><div class="line">    <span class="comment">// require('data') is external and available</span></div><div class="line">    <span class="comment">//  on the global var data</span></div><div class="line">    <span class="string">'data'</span>: <span class="string">'data'</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>现在，你可以在js中像引用模块变量一样加载data，但是它实际上是一个全局变量<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// main.jsx</span></div><div class="line"><span class="keyword">var</span> data = <span class="built_in">require</span>(<span class="string">'data'</span>);</div><div class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'react'</span>);</div><div class="line"><span class="keyword">var</span> ReactDOM = <span class="built_in">require</span>(<span class="string">'react-dom'</span>);</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;data&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>,</div><div class="line">  <span class="built_in">document</span>.body</div><div class="line">);</div></pre></td></tr></table></figure></p>
<h3 id="Hot-Module-Replacement"><a href="#Hot-Module-Replacement" class="headerlink" title="Hot Module Replacement"></a>Hot Module Replacement</h3><p>Hot Module Replacement()热加载能够在修改后对应用进行实时加载而不需要重新加载，你能够使用两种方法开启热加载<br>（1）在命令行追加“–hot”和”–inline“<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ webpack-dev-server --hot --inline</div></pre></td></tr></table></figure></p>
<ul>
<li>–hot: 添加HotModuleReplacementPlugin并似的服务进入热加载模式</li>
<li>–inline: webpack-dev-server在运行中进行bundle</li>
<li>–hot –inline: 同时添加上面两个命令的功能<br>（2）编辑webpack配置文件</li>
<li>添加HotModuleReplacementPlugin扩展</li>
<li>在entry中添加 webpack/hot/dev-server 和 webpack-dev-server/client?<a href="http://localhost:8080" target="_blank" rel="external">http://localhost:8080</a></li>
</ul>
<p>webpack的配置文件就像下面这样<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: [</div><div class="line">    <span class="string">'webpack/hot/dev-server'</span>,</div><div class="line">    <span class="string">'webpack-dev-server/client?http://localhost:8080'</span>,</div><div class="line">    <span class="string">'./index.js'</span></div><div class="line">  ],</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span>,</div><div class="line">    <span class="attr">publicPath</span>: <span class="string">'/static/'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: [</div><div class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</div><div class="line">  ],</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">loaders</span>: [&#123;</div><div class="line">      <span class="attr">test</span>: <span class="regexp">/\.jsx?$/</span>,</div><div class="line">      <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</div><div class="line">      <span class="attr">loader</span>: <span class="string">'babel-loader'</span>,</div><div class="line">      <span class="attr">query</span>: &#123;</div><div class="line">        <span class="attr">presets</span>: [<span class="string">'es2015'</span>, <span class="string">'react'</span>]</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">include</span>: path.join(__dirname, <span class="string">'.'</span>)</div><div class="line">    &#125;]</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>现在我们可以像之前一样启动服务了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ webpack-dev-server</div></pre></td></tr></table></figure></p>
<p>其实还有很多配置参数没有讲到，<a href="https://github.com/webpack/docs/wiki/configuration#configuration-object-content" target="_blank" rel="external">配置项参考文档</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/13/Webpack学习笔记一/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="辣鸡Coder">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="普通程序员的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="普通程序员的博客" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/13/Webpack学习笔记一/" itemprop="url">
                  Webpack学习笔记一
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-13T12:44:12+08:00">
                2017-01-13
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          
             <span id="/2017/01/13/Webpack学习笔记一/" class="leancloud_visitors" data-flag-title="Webpack学习笔记一">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>按照webpack-demos的顺序进行了学习，结合自己的理解简单的翻译了一下，食用原repository更佳,<a href="https://github.com/ruanyf/webpack-demos" target="_blank" rel="external">点我看原repo,给作者个star</a></p>
</blockquote>
<hr>
<h3 id="What-is-Webpack"><a href="#What-is-Webpack" class="headerlink" title="What is Webpack"></a>What is Webpack</h3><p>Webpack是一个前端打包工具，能够将模块和依赖进行整合输出。</p>
<p>Webpack的配置文件是webpack.config.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">"entryFileUrl"</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">"outputFileUrl"</span></div><div class="line">  &#125;</div><div class="line">  <span class="comment">//.....</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>当你游了配置文件后，就可以使用webpack命令进行编译，一些基本的命令行指令是你需要知道</p>
<ul>
<li>webpack  在开发环境下执行一次编译</li>
<li>webpack -p  在生产环境下执行一次编译，对源码进行压缩混淆</li>
<li>webpack –watch  对程序进行监听并持续打包编译</li>
<li>webpack -d  打包时生成map映射文件</li>
<li>webpack –colors  更美观？</li>
</ul>
<p>你也可以在package.json配置文件中的“scripts”进行配置<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">"scripts": &#123;</div><div class="line">  "dev": "webpack-dev-server",</div><div class="line">  "deploy": "NODE_ENV=production webpack -p"</div><div class="line">&#125;,</div></pre></td></tr></table></figure></p>
<h3 id="Entry-file-and-build"><a href="#Entry-file-and-build" class="headerlink" title="Entry file and build"></a>Entry file and build</h3><p>entry告诉webpack根据哪一个文件进行打包，output则表示打包编译后输出文件的目录，for example<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">"./main.js"</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">"build.js"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p> main.js就是entry file，build.js就是经过打包后输出的文件。</p>
<h3 id="多入口文件"><a href="#多入口文件" class="headerlink" title="多入口文件"></a>多入口文件</h3><p>Webpack允许多入口文件的配置，这可以用于多页面应用中。<br>example<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: &#123;</div><div class="line">    <span class="string">"build1"</span>: <span class="string">'./main1.js'</span>,</div><div class="line">    <span class="string">"build2"</span>: <span class="string">'./main2.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'[name].js'</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>entry由字符串变成对象，并在其中添加[编译名的文件名]:[入口文件Url]组成的键值对；<br>output由指定的文件名变成[name].js，根据entry指定的name来打包编译。</p>
<h3 id="Loaders"><a href="#Loaders" class="headerlink" title="Loaders"></a>Loaders</h3><p>Loaders也叫加载器，它能够为你的应用对源文件做进一步的处理。</p>
<h4 id="Babel-loader"><a href="#Babel-loader" class="headerlink" title="Babel-loader"></a>Babel-loader</h4><p>打个比方，<a href="https://github.com/babel/babel-loader" target="_blank" rel="external">Babel-loader</a>能够将JSX/Es6转换成浏览器能够识别的js文件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">"./main.js"</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">"build.js"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">Loaders</span>: [</div><div class="line">      <span class="comment">// ===Babel加载器===begin</span></div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">        <span class="attr">exclude</span>: <span class="regexp">/(node_modules|bower_components)/</span>,</div><div class="line">        <span class="attr">loader</span>: <span class="string">'babel-loader'</span>,</div><div class="line">        <span class="attr">query</span>: &#123;</div><div class="line">          <span class="attr">presets</span>: [<span class="string">'es2015'</span>]</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">      <span class="comment">//===end</span></div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Css-loader"><a href="#Css-loader" class="headerlink" title="Css-loader"></a>Css-loader</h4><p>  在js中有时需要加载css样式表文件，Css-loader可以胜任这项工作。<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'./main.js'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">loaders</span>:[</div><div class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">loader</span>: <span class="string">'style-loader!css-loader'</span> &#125;,</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h4 id="Image-loader"><a href="#Image-loader" class="headerlink" title="Image-loader"></a>Image-loader</h4><p>  在js中引用img文件<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//..省略其他部分</span></div><div class="line">loaders:[</div><div class="line">  &#123; <span class="attr">test</span>: <span class="regexp">/\.(png|jpg)$/</span>, <span class="attr">loader</span>: <span class="string">'url-loader?limit=8192'</span> &#125;</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>  url-loader会将图片进行转换，如果图片小于8192bytes，将会转换成Base64的Data URL；反过来，就转换成正常的路径。<br>  假设有两张一大一小的图片，第一张小于8192bytes，第二张则大于。那么两者会被换成这样：</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 小图转换成Base64 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"data:image/png;base64,iVBOR...uQmCC"</span>&gt;</span>  </div><div class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"4853ca667a2b8b8844eb2693ac1b2578.png"</span>&gt;</span></div></pre></td></tr></table></figure>
<h4 id="Css-Module"><a href="#Css-Module" class="headerlink" title="Css Module"></a>Css Module</h4><p>css-loader?modules 能够开启加载的Css模块中的属性的作用域。<br>也就是说你导入的css模块中的属性默认是本地的、局部的，你能选择使用:global(…)将选择器提升为全局。<a href="https://css-modules.github.io/webpack-demo/" target="_blank" rel="external">详细</a><br>index.heml<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"h1"</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"h2"</span>&gt;</span>Hello Webpack<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>app.css<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.h1</span> &#123;</div><div class="line">  <span class="attribute">color</span>:red;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-pseudo">:global(.h2)</span> &#123;</div><div class="line">  <span class="attribute">color</span>: blue;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>main.JSX<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'react'</span>);</div><div class="line"><span class="keyword">var</span> ReactDOM = <span class="built_in">require</span>(<span class="string">'react-dom'</span>);</div><div class="line"><span class="keyword">var</span> style = <span class="built_in">require</span>(<span class="string">'./app.css'</span>);</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">className</span>=<span class="string">&#123;style.h1&#125;</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">"h2"</span>&gt;</span>Hello Webpack<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span>,</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'example'</span>)</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p>webpack.config.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'./main.jsx'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">loaders</span>:[</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.js[x]?$/</span>,</div><div class="line">        <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</div><div class="line">        <span class="attr">loader</span>: <span class="string">'babel-loader'</span>,</div><div class="line">        <span class="attr">query</span>: &#123;</div><div class="line">          <span class="attr">presets</span>: [<span class="string">'es2015'</span>, <span class="string">'react'</span>]</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</div><div class="line">        <span class="attr">loader</span>: <span class="string">'style-loader!css-loader?modules'</span>  <span class="comment">//注意⚠️ ?modules</span></div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>第一个h1不会有任何变化，因为没有定义全局的.h1选择器；<br>第二个h1为红色，由于.h1的作用范围为本地，所以style.h1能够正确找到选择器；<br>h2均为蓝色，其是通过:global(.h2){…}定义的选择器，所以作用范围为全部。<br><img src="/2017/01/13/Webpack学习笔记一/css-module.png" alt="运行结果" title="运行结果"></p>
<h3 id="Plugin"><a href="#Plugin" class="headerlink" title="Plugin"></a>Plugin</h3><h4 id="UglifyJs-Plugin"><a href="#UglifyJs-Plugin" class="headerlink" title="UglifyJs Plugin"></a>UglifyJs Plugin</h4><p>Webpack 有它自己的插件用来扩展方法。比如<a href="http://webpack.github.io/docs/list-of-plugins.html#uglifyjsplugin" target="_blank" rel="external">UglifyJs plugin</a>会最小化的输出编译过后的js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">var</span> uglifyJsPlugin = webpack.optimize.UglifyJsPlugin;</div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'./main.js'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: [</div><div class="line">    <span class="keyword">new</span> uglifyJsPlugin(&#123;</div><div class="line">      <span class="attr">compress</span>: &#123;</div><div class="line">        <span class="attr">warnings</span>: <span class="literal">false</span></div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line">  ]</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>打包编译后，bundle.js会被最小化输出。类似于<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o=<span class="string">"Hello"</span>;o+=<span class="string">" World"</span>,<span class="built_in">document</span>.write(<span class="string">"&lt;h1&gt;"</span>+o+<span class="string">"&lt;/h1&gt;"</span>)</div></pre></td></tr></table></figure></p>
<h4 id="HTML-Webpack-Plugin-and-Open-Browser-Webpack-Plugin"><a href="#HTML-Webpack-Plugin-and-Open-Browser-Webpack-Plugin" class="headerlink" title="HTML Webpack Plugin and Open Browser Webpack Plugin"></a>HTML Webpack Plugin and Open Browser Webpack Plugin</h4><p>webpack还可以使用第三方的插件。<br>HTML Webpack Plugin 能够为你自动生成一个index.html，<br>Open Browser Webpack Plugin能够在webpack服务运行的时候打开一个新的浏览器标签并载入页面<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> HtmlwebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</div><div class="line"><span class="keyword">var</span> OpenBrowserPlugin = <span class="built_in">require</span>(<span class="string">'open-browser-webpack-plugin'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'./main.js'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: [</div><div class="line">    <span class="keyword">new</span> HtmlwebpackPlugin(&#123;</div><div class="line">      <span class="attr">title</span>: <span class="string">"webpack-demo"</span>,</div><div class="line">      <span class="attr">filename</span>: <span class="string">"index.html"</span></div><div class="line">    &#125;),</div><div class="line">    <span class="keyword">new</span> OpenBrowserPlugin(&#123;</div><div class="line">      <span class="attr">url</span>: <span class="string">"http://localhost:8080"</span></div><div class="line">    &#125;)</div><div class="line">  ]</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>运行webpack-dev-save，现在你不需要自己创建index.html和打开浏览器了。👍</p>
<h4 id="Environment-flags"><a href="#Environment-flags" class="headerlink" title="Environment flags"></a>Environment flags</h4><p>你还能利用环境标志，让部分代码只能运行在开发环境中<br>main.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">document</span>.write(<span class="string">'&lt;h1&gt;Environment flags&lt;/h1&gt;'</span>)</div><div class="line"><span class="keyword">if</span> (__DEV__)&#123;</div><div class="line">  <span class="built_in">document</span>.write(<span class="keyword">new</span> <span class="built_in">Date</span>());</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>webpack.config.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> devFlagPlugin = <span class="keyword">new</span> webpack.DefinePlugin(&#123;</div><div class="line">  <span class="attr">__DEV__</span>: <span class="built_in">JSON</span>.stringify(<span class="built_in">JSON</span>.parse(process.env.DEBUG || <span class="string">'false'</span>))</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'./main.js'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: [devFlagPlugin]</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>现在运行webpack<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Linux $ Mac</div><div class="line">$ env DEBUG=true webpack-dev-server</div><div class="line"></div><div class="line"># Windows</div><div class="line">$ set DEBUG=true</div><div class="line">$ webpack-dev-server</div></pre></td></tr></table></figure></p>
<img src="/2017/01/13/Webpack学习笔记一/environment.png" alt="运行结果" title="运行结果">
<h3 id="Code-splitting"><a href="#Code-splitting" class="headerlink" title="Code splitting"></a>Code splitting</h3><p>在大型项目中，将所有的代码放在一个文件中是极其没有效率的一件事件。webpack允许将其分割成许多不同的块，并按照需求进行加载。<br>首先，用require.ensure定义一个分割点<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>.ensure([<span class="string">'./a'</span>],<span class="function"><span class="keyword">function</span>(<span class="params">require</span>)</span>&#123;</div><div class="line">  vat content  = <span class="built_in">require</span>(<span class="string">'./a'</span>)</div><div class="line">  <span class="built_in">document</span>.open()</div><div class="line">  <span class="built_in">document</span>.write(<span class="string">'&lt;h1&gt;Environment flags&lt;/h1&gt;'</span>)</div><div class="line">  <span class="built_in">document</span>.colors()</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>require.ensure 告诉webpack “a.js”应该被分开加载并打包为一个文件。<br>另外一种方法是使用<a href="https://www.npmjs.com/package/bundle-loader" target="_blank" rel="external">bundle-loader</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// main.js</span></div><div class="line"></div><div class="line"><span class="comment">// Now a.js is requested, it will be bundled into another file</span></div><div class="line"><span class="keyword">var</span> load = <span class="built_in">require</span>(<span class="string">'bundle-loader!./a.js'</span>);</div><div class="line"></div><div class="line"><span class="comment">// To wait until a.js is available (and get the exports)</span></div><div class="line"><span class="comment">//  you need to async wait for it.</span></div><div class="line">load(<span class="function"><span class="keyword">function</span>(<span class="params">file</span>) </span>&#123;</div><div class="line">  <span class="built_in">document</span>.open();</div><div class="line">  <span class="built_in">document</span>.write(<span class="string">'&lt;h1&gt;'</span> + file + <span class="string">'&lt;/h1&gt;'</span>);</div><div class="line">  <span class="built_in">document</span>.close();</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/09/面向对象的程序设计-Javascript继承/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="辣鸡Coder">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="普通程序员的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="普通程序员的博客" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/09/面向对象的程序设计-Javascript继承/" itemprop="url">
                  面向对象的程序设计-Javascript继承
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-09T10:58:13+08:00">
                2017-01-09
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          
             <span id="/2017/01/09/面向对象的程序设计-Javascript继承/" class="leancloud_visitors" data-flag-title="面向对象的程序设计-Javascript继承">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>上次学习巩固了js创建对象的方法，有对象就有继承。许多OO语言都支持两种继承方式：接口继承和实现继承，ECMAScript无法进行接口继承，只能依靠原型链实现继承。</p>
</blockquote>
<h2 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>原型链的基本思想是让一个引用类型继承另一个引用类型的属性和方法。<br>回顾一下构造函数、实例、原型对象之间的关系：每一个构造函数都有一个原型对象，每个原型对象都包含一个指向其构造函数的指针，构造函数的实例都拥有一个指针，指向构造函数的原型对象内部。<br>如果我们让原型对象等于另一个类型的实例，那么此时的原型对象将包含指向另一个类型的原型对象的指针，当然这个另一个原型中肯定也包含指向另一个构造函数的指针；假设另一个类型的原型对象又等于另外一个类型的的实例，那么上述关系依然成立，如此层层叠加就构成了实例和原型的链条。<br>这就是原型链的概念。是不是看完后更晕了，没关系让我们来举个例子。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.superValue = <span class="literal">true</span></div><div class="line">&#125;</div><div class="line">SuperType.prototype.getSuperValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.superValue</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.subValue = <span class="literal">false</span></div><div class="line">&#125;</div><div class="line"><span class="comment">//继承了SuperType</span></div><div class="line">SubType.prototype = <span class="keyword">new</span> SuperType()</div><div class="line">SubType.prototype.constructor = SubType</div><div class="line"><span class="comment">// 对子类设置方法或覆盖父类的方法时，需要定义在重写了原型之后</span></div><div class="line"><span class="comment">// 定义prototype时不可使用字面量对象定义</span></div><div class="line"><span class="comment">// subtype.prototype = &#123;....&#125; 这样会切断其和父对象的链接</span></div><div class="line">SubType.prototype.getSubValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.subValue</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> instance = <span class="keyword">new</span> SubType()</div><div class="line"><span class="built_in">console</span>.log(instance.getSuperValue())</div></pre></td></tr></table></figure></p>
<p>以前看的<a href="http://www.ruanyifeng.com/blog/2011/06/designing_ideas_of_inheritance_mechanism_in_javascript.html" target="_blank" rel="external">阮一峰的网络日志</a>中会将SubType.prototype.constructor进行纠正，也就是<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SubType.prototype.constructor = SubType</div></pre></td></tr></table></figure></p>
<p>然而这次读《JavaScript高级程序设计》的时候，书里没有写到要将constructor重置。查阅了一下资料，发觉constructor在ECMAScript中似乎没有特别的意义。纠正constructor确实可以避免原型链的紊乱，不写感觉问题也不大（如果用到了constructor属性，那还是有必要纠正的）。原型链的紊乱会导致无法正常使用instanceof和isPrototypeOf方法<br><a href="http://stackoverflow.com/questions/8453887/why-is-it-necessary-to-set-the-prototype-constructor" target="_blank" rel="external">Why is it necessary to set the prototype constructor?</a>StackOverflow上的这个问题估计能解决你的疑惑</p>
<p>栗子中有一个SuperType这样一个构造函数，我们给他定义了属性并在原型上定义了一个getSuperValue的方法。接着我们又定义subtype构造函数，并将其原型重写为SuperType的实例，从而实现了继承。SubType的实例不仅拥有Subtype自身的方法和属性，还拥有从Supertype上继承而来的属性和方法。如果又有一个类型继承了SubType那么它就同时继承了subtype和supertype，如此层层叠加是不是就构成了实例和原型的链条。</p>
<h3 id="原型链存在的问题"><a href="#原型链存在的问题" class="headerlink" title="原型链存在的问题"></a>原型链存在的问题</h3><p>当原型链上的值为引用类型时，会存在一个共享的问题，这条原型链上所有的实例都会共享这些引用类型的值。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.colors = [<span class="string">"blue"</span>,<span class="string">"green"</span>,<span class="string">"red"</span>]</div><div class="line">&#125;</div><div class="line">SuperType.prototype.getSuperValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.colors</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.subValue = <span class="literal">false</span></div><div class="line">&#125;</div><div class="line">SubType.prototype = <span class="keyword">new</span> SuperType()</div><div class="line">SubType.prototype.getSubValue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.subValue</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> instence1 = <span class="keyword">new</span> SubType()</div><div class="line">instence1.colors.push(<span class="string">"black"</span>)</div><div class="line"><span class="built_in">console</span>.log(instence1.getSuperValue())</div><div class="line"><span class="keyword">let</span> instence2 = <span class="keyword">new</span> SubType()</div><div class="line"><span class="built_in">console</span>.log(instence2.getSuperValue())</div></pre></td></tr></table></figure></p>
<p>subtype的原型重写为Supertype的实例后，构造函数中的属性colors就变成了定义在原型上的colors了，造成了相互影响，实际使用中很少单独使用原型链。</p>
<h2 id="借用构造函数"><a href="#借用构造函数" class="headerlink" title="借用构造函数"></a>借用构造函数</h2><p>在解决原型中包含引用类型值所带来的问题中，开发人员开始使用一种叫做借用构造函数的技术(有时候也叫伪对象或经典继承)。即通过apply或call在子类的构造函数内部调用父类的构造函数，如下<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.colors = [<span class="string">"blue"</span>,<span class="string">"green"</span>,<span class="string">"red"</span>]</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  SuperType.call(<span class="keyword">this</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> instence1 = <span class="keyword">new</span> SubType()</div><div class="line">instence1.colors.push(<span class="string">"black"</span>)</div><div class="line"><span class="built_in">console</span>.log(instence1.colors)</div><div class="line"><span class="keyword">let</span> instence2 = <span class="keyword">new</span> SubType()</div><div class="line"><span class="built_in">console</span>.log(instence2.colors)</div></pre></td></tr></table></figure></p>
<p>虽然借用构造方法是解决了引用值带来的问题，但是也无法避免构造函数模式带来的问题——方法都在构造函数中定义，函数的复用无从谈起、超类的方法对子类而言是不可见的等等，这种方法同样也很少单独使用。</p>
<h2 id="组合继承"><a href="#组合继承" class="headerlink" title="组合继承"></a>组合继承</h2><p>组合继承也被称为伪经典继承，结合和原型链和构造函数两者的优点。分别由构造函数对实例的属性和方法进行继承，原型链负责对原型的方法属性继承。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name = <span class="string">"admin"</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = name</div><div class="line">  <span class="keyword">this</span>.colors = [<span class="string">"blue"</span>,<span class="string">"green"</span>,<span class="string">"red"</span>]</div><div class="line">&#125;</div><div class="line">SuperType.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.name</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name, age = <span class="number">20</span></span>)</span>&#123;</div><div class="line">  SuperType.call(<span class="keyword">this</span>, name)</div><div class="line">  <span class="keyword">this</span>.age = age</div><div class="line">&#125;</div><div class="line">SubType.prototype = <span class="keyword">new</span> SuperType()</div><div class="line"><span class="keyword">let</span> instence1 = <span class="keyword">new</span> SubType()</div><div class="line">instence1.colors.push(<span class="string">"black"</span>)</div><div class="line"><span class="built_in">console</span>.log(instence1.colors) <span class="comment">//["blue", "green", "red", "black"]</span></div><div class="line"><span class="keyword">let</span> instence2 = <span class="keyword">new</span> SubType(<span class="string">"tool"</span>)</div><div class="line"><span class="built_in">console</span>.log(instence2.colors) <span class="comment">//["blue", "green", "red"]</span></div><div class="line"><span class="built_in">console</span>.log(instence2.getName()) <span class="comment">//"tool"</span></div></pre></td></tr></table></figure></p>
<p>在subtype构造函数中通过调用父类的构造函数创建了name和colors，从而在之后调用的时候会先在subtype中查找这两个变量，找到后便不会再往上对原型进行查找。</p>
<blockquote>
<p>组合继承避免了原型链和借用构造函数的缺陷，融合了他们优点，成为JavaScript中最常用的继承模式。</p>
</blockquote>
<h2 id="原型式继承"><a href="#原型式继承" class="headerlink" title="原型式继承"></a>原型式继承</h2><blockquote>
<p>道格拉斯·克罗克福德写过一篇文章介绍了一种实现继承的方法，这种方法没有严格意义上的构造函数。他的想法是借助原型基于已有的对象创建新的对象，同时还不必创建新的类型，给出如下函数。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">object</span>(<span class="params">o</span>)</span>&#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">  F.prototype = o</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> F()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在obect内部创建了一个临时构造函数，将传入的o作为F的对象并返回F的实例。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> parson  = &#123;</div><div class="line">  <span class="attr">name</span> : <span class="string">"man"</span>,</div><div class="line">  <span class="attr">friends</span> : [<span class="string">"apple"</span>,<span class="string">"sanmu"</span>]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">object</span>(<span class="params">o</span>)</span>&#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">  F.prototype = o</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> F()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> people = object(parson)</div><div class="line"><span class="keyword">var</span> people_2 = object(parson)</div><div class="line">people.friends.push(<span class="string">"abc"</span>)</div><div class="line">people.name = <span class="string">"Greg"</span></div><div class="line"><span class="built_in">console</span>.log(people)</div><div class="line"><span class="built_in">console</span>.log(people_2.friends)</div></pre></td></tr></table></figure></p>
<p>这种原型式的继承需要你有一个对象作为另一个对象的基础，将这个对象作为参数传入，然后根据需求对返回的对象进行修改。由于是利用了原型来实现的，避免不了friends被所有的实例共享。ECMAScript5通过新增Object.create()规范了这种原型式继承。在简单的只想让一个对象与另一个对象保持类似的情况下， 这种继承是完全可以胜任的。</p>
<h2 id="寄生式继承"><a href="#寄生式继承" class="headerlink" title="寄生式继承"></a>寄生式继承</h2><p>寄生式继承和上面的原型式继承方式密不可分，毕竟都是一个人推广的。简单的说就是利用原型式继承进行继承并对得到的对象增加额外的方法和属性，并把这一过程进行封装。看个栗子就懂了，还是用到上面的object方法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createAnother</span>(<span class="params">original</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> clone = object(original)</div><div class="line">  clone.sayHi = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    alert(<span class="string">"Hi"</span>)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> clone;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>寄生式继承由于无法对函数进行复用，每个不同的对象都需要封装一个不同的方法，这点和构造函数模式类似。</p>
<h2 id="寄生组合式继承"><a href="#寄生组合式继承" class="headerlink" title="寄生组合式继承"></a>寄生组合式继承</h2><p>上面讲到组合继承是比较常用的继承方式，然而他也有明显的缺点。即调用了两次超类构造函数，在给定义子类prototype时生成了许多多余的元素，然而寄生组合式继承能够比较完美的解决这一问题。利用寄生式继承的方式，继承超类的原型，并赋值给子类。其基本模式如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">inhert</span>(<span class="params">subType, superType</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> prototype = object.(superType.prototype)</div><div class="line">  prototype.constructor = subType</div><div class="line">  subType.prototype = prototype</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>inhert函数实现了寄生组合式继承的最简单形式。接受子类型和父类型两个参数，首先通过原型式继承将父类型的原型对象创建一个副本原型对象，第二步纠正丢失的constructor属性，最后将父类的原型副本赋值给子类的原型。采用这种继承方式，我们可以将组合继承中的例子改为这样：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name = <span class="string">"admin"</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = name</div><div class="line">  <span class="keyword">this</span>.colors = [<span class="string">"blue"</span>,<span class="string">"green"</span>,<span class="string">"red"</span>]</div><div class="line">&#125;</div><div class="line">SuperType.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.name</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name, age = <span class="number">20</span></span>)</span>&#123;</div><div class="line">  SuperType.call(<span class="keyword">this</span>, name)</div><div class="line">  <span class="keyword">this</span>.age = age</div><div class="line">&#125;</div><div class="line">inhert(SubType, SuperType) <span class="comment">//寄生组合式继承</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> instence1 = <span class="keyword">new</span> SubType()</div><div class="line">instence1.colors.push(<span class="string">"black"</span>)</div><div class="line"><span class="built_in">console</span>.log(instence1.colors) <span class="comment">//["blue", "green", "red", "black"]</span></div><div class="line"><span class="keyword">let</span> instence2 = <span class="keyword">new</span> SubType(<span class="string">"tool"</span>)</div><div class="line"><span class="built_in">console</span>.log(instence2.colors) <span class="comment">//["blue", "green", "red"]</span></div><div class="line"><span class="built_in">console</span>.log(instence2.getName()) <span class="comment">//"tool"</span></div></pre></td></tr></table></figure></p>
<p>这个例子的高效率体现在它只调用了一次SuperType的构造函数，避免了在SubType.prototype上创建不必要的、多余的属性。与此同时原型链保持不变；因此能够正常使用instanceof()和isPrototypeOf()。可以说这种方式是优于组合继承式的</p>
<p>–本文完</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/04/JavaScript面向对象的程序设计-红宝书第六章学习笔记/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="辣鸡Coder">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="普通程序员的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="普通程序员的博客" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/04/JavaScript面向对象的程序设计-红宝书第六章学习笔记/" itemprop="url">
                  JavaScript面向对象的程序设计-类的创建
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-04T15:28:41+08:00">
                2017-01-04
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          
             <span id="/2017/01/04/JavaScript面向对象的程序设计-红宝书第六章学习笔记/" class="leancloud_visitors" data-flag-title="JavaScript面向对象的程序设计-类的创建">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>面向对象的编程语言都有一个特征，就是拥有类的概念，通过类可以创建任意多个具有相同属性和方法的对象。然而众所周知，ECMAScript中没有类的概念，因此它的对象也与其他基于类的语言中的对象有所不同。</p>
</blockquote>
<p>  JavaScript中用对象模拟其他语言中的类，有下面几种模式对类进行创建。</p>
<h2 id="构造函数模式"><a href="#构造函数模式" class="headerlink" title="构造函数模式"></a>构造函数模式</h2><p>  ECMAScript中的构造函数能够创建特定类型的对象，像Array，Object这样的原生构造函数，我们也可以创建自定义的构造函数。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>)</span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = name</div><div class="line">  <span class="keyword">this</span>.age = age</div><div class="line">  <span class="keyword">this</span>.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    alert(<span class="keyword">this</span>.name)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>  Person构造函数就相当于Person类的构造函数一样的存在，当需要创建Person实例时，需要使用new操作符，实例生成步骤如下。</p>
<ol>
<li>创建一个新的对象</li>
<li>将构造函数的作用域赋给新对象，this指向新对象</li>
<li>执行构造函数中的代码，为新对象添加属性方法等</li>
<li>返回新对象<br>构造函数的问题: 上个栗子中有一个sayName的方法，每new一个Person都会产生一个新的实例，一个新的sayName方法。创建两个功能相同的方法实在是没有什么必要，为此就有了下面一种方法”原型模式”<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> person1 = <span class="keyword">new</span> Person()</div><div class="line"><span class="keyword">let</span> person2 = <span class="keyword">new</span> Person()</div><div class="line"><span class="built_in">console</span>.log(person1.sayName === person2.sayName) <span class="comment">//false</span></div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="原型模式"><a href="#原型模式" class="headerlink" title="原型模式"></a>原型模式</h2><p>  我们每创建一个函数都会有一个prototype(原型)属性，这属性是一个指针，指向一个对象，这个对象的作用就是包含由特定类型的所有实例共享的属性和方法。使用原型的好处是可以让所有实例共享构造函数的属性和方法，换句话说就是将构造函数模式中定义在构造函数内的属性和方法定义在构造函数的prototype上。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">Person.prototype.name = <span class="string">"Joker"</span></div><div class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  alert(<span class="keyword">this</span>.name)</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> person1 = <span class="keyword">new</span> Person()</div><div class="line"><span class="keyword">let</span> person2 = <span class="keyword">new</span> Person()</div><div class="line"><span class="built_in">console</span>.log(person1.sayName === person2.sayName) <span class="comment">//true</span></div></pre></td></tr></table></figure></p>
<p>  创建了自定义构造函数Person()后，其原型对象会自动生成一个constructor指向Person。当调用构造函数生成实例后，实例会有一个[[prototype]]属性，虽然这个属性在js中没有明确的访问方式，不过Firefox、chrome和Safari都有一个<strong>proto</strong>表示，实例的[[prototype]]指向构造函数的prototype。<br><img src="/2017/01/04/JavaScript面向对象的程序设计-红宝书第六章学习笔记/prototype.png" alt="实例与原型的关系" title="实例与原型的关系"><br>然而原型模式也存在着问题，定义在prototype上的函数或方法是被所有的实例所共享的。如果是值类型的属性倒也还好，当属性为引用类型时就会出现问题。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">Person.prototype.borther = [<span class="string">"apple"</span>,<span class="string">"Logitech"</span>]</div><div class="line"><span class="keyword">let</span> person1 = <span class="keyword">new</span> Person()</div><div class="line"><span class="keyword">let</span> person2 = <span class="keyword">new</span> Person()</div><div class="line">person1.borther.push(<span class="string">"MacBook"</span>)</div><div class="line"><span class="built_in">console</span>.log(person1.borther) <span class="comment">//["apple", "Logitech", "MacBook"]</span></div><div class="line"><span class="built_in">console</span>.log(person2.borther) <span class="comment">//["apple", "Logitech", "MacBook"]</span></div></pre></td></tr></table></figure></p>
<p>所以就有了下面这种创建类的模式</p>
<h2 id="组合使用构造函数和原型模式"><a href="#组合使用构造函数和原型模式" class="headerlink" title="组合使用构造函数和原型模式"></a>组合使用构造函数和原型模式</h2><p>组合使用构造函数和原型可以说是创建自定义类型比较常见的方式，使用构造函数来定义实例属性，原型模式定义方法和共享的属性。每个实例都有自己的实例属性，同时又共享对方法的引用，最大限度的节省了内存。同时这种方法还能够向构造函数传递参数，可谓集两者之所长。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name = <span class="string">"people"</span>, borther = [<span class="string">"Apple"</span>]</span>)</span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = name</div><div class="line">  <span class="keyword">this</span>.borther = borther</div><div class="line">&#125;</div><div class="line">Person.prototype = &#123;</div><div class="line">  <span class="attr">constructor</span>: Person,</div><div class="line">  sayName()&#123;</div><div class="line">    alert(<span class="keyword">this</span>.name</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> person1 = <span class="keyword">new</span> Person()</div><div class="line"><span class="keyword">let</span> person2 = <span class="keyword">new</span> Person(<span class="string">"superman"</span>, [<span class="string">"蜘蛛侠"</span>, <span class="string">"钢铁侠"</span>])</div></pre></td></tr></table></figure></p>
<p>两个实例都拥有各自的name和brother，以及共享的sayName方法。</p>
<h2 id="动态原型模式"><a href="#动态原型模式" class="headerlink" title="动态原型模式"></a>动态原型模式</h2><p>创建类的时候需要将有独立的构造函数和原型，似乎不太合理，动态原型模式使得这一问题得以解决。它把所有的信息都封装在了构造函数中，既能通过在构造函数中检查并初始化原型，又能保持组合创建的优点。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>)</span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = name</div><div class="line">  <span class="keyword">this</span>.age = age</div><div class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="keyword">this</span>.sayName !== <span class="string">"function"</span>)&#123;</div><div class="line">    Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      alert(<span class="keyword">this</span>.name)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="寄生构造函数模式"><a href="#寄生构造函数模式" class="headerlink" title="寄生构造函数模式"></a>寄生构造函数模式</h2><p>–也是第一次听到这个模式，书上说在前几种模式不适用的情况下可以采用这一种模式。思想是创建一个函数，函数的作用仅仅是封装创建的代码，然后返回新创建的对象。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> o =<span class="keyword">new</span> <span class="built_in">Object</span>()</div><div class="line">  o.name = name;</div><div class="line">  o.age = age;</div><div class="line">  o.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    alert(<span class="keyword">this</span>.name)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> o</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这个模式可以在特殊情况下为对象创建构造函数。假设我们要创建一个具有额外方法的特殊数组，因为不能直接改造Array，可以使用这个模式。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SpecialArray</span>(<span class="params">...arg</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> values = <span class="keyword">new</span> <span class="built_in">Array</span>()</div><div class="line">  values.push.apply(values, arg)</div><div class="line">  values.toPipedString = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.join(<span class="string">"|"</span>)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> values</div><div class="line"> &#125;</div><div class="line"> <span class="keyword">var</span> colors = <span class="keyword">new</span> SpecialArray(<span class="string">"red"</span>, <span class="string">"blue"</span>, <span class="string">"yellow"</span>)</div><div class="line"> <span class="built_in">console</span>.log(colors.toPopedString()) <span class="comment">//"red|blue|yellow"</span></div></pre></td></tr></table></figure></p>
<p> 关于寄生构造函数模式，返回的对象和构造函数、构造函数原型属性之间没人有何关系，也就是说函数返回的对象和其外部创建的对象没什么区别。在可以用其他模式的情况下<strong><em>不要使用这种模式</em></strong></p>
<h2 id="稳妥构造函数模式"><a href="#稳妥构造函数模式" class="headerlink" title="稳妥构造函数模式"></a>稳妥构造函数模式</h2><p> 稳妥构造函数和寄生构造函数模式类似，但有亮点不同:一是新创建的对象实例方法不引用this，二是不适用new调用构造函数。<br> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SpecialArray</span>(<span class="params">name, ...arg</span>)</span>&#123;</div><div class="line"> <span class="keyword">var</span> values = <span class="keyword">new</span> <span class="built_in">Object</span>()</div><div class="line"> values.toPipedString = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   <span class="built_in">console</span>.log(name)</div><div class="line"> &#125;</div><div class="line"> <span class="keyword">return</span> values</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> colors = SpecialArray(<span class="string">"red"</span>, <span class="string">"blue"</span>, <span class="string">"yellow"</span>)</div><div class="line">colors.toPipedString() <span class="comment">//red</span></div><div class="line"><span class="built_in">console</span>.log(colors.name) <span class="comment">//undefined</span></div></pre></td></tr></table></figure></p>
<p>在这种模式创建的对象中只有toPipedString方法能访问name，没有别的办法访问。这种安全性使它适用于某些安全执行环境。</p>
<p>整理完了几种创建类的方式，接着会整理一下继承的一些方式。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/01/2016各大互联网公司前端面试汇总自测（上）/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="辣鸡Coder">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="普通程序员的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="普通程序员的博客" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/01/2016各大互联网公司前端面试汇总自测（上）/" itemprop="url">
                  各大互联网公司前端面试汇总（上）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-01T13:33:06+08:00">
                2017-01-01
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          
             <span id="/2017/01/01/2016各大互联网公司前端面试汇总自测（上）/" class="leancloud_visitors" data-flag-title="各大互联网公司前端面试汇总（上）">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2017年的第一天，祝大家都能在新的一年里实现自己的小愿望。元旦回乡下没出去，逛掘金的时候发现了<a href="https://gold.xitu.io/entry/58678b6861ff4b006dba626b/detail?utm_source=gold_browser_extension" target="_blank" rel="external">2016各大互联网公司前端面试题汇总</a>这篇文章,正好刷一下提前做好准备。答案均为自己的理解，毕竟是菜鸟难免有错误的地方还请多多指正。</p>
<h1 id="百度"><a href="#百度" class="headerlink" title="百度"></a>百度</h1><img src="/2017/01/01/2016各大互联网公司前端面试汇总自测（上）/1024px-Baidu.svg.png" alt="1024px-Baidu.svg.png" title="">
<h2 id="写出javascript运行结果"><a href="#写出javascript运行结果" class="headerlink" title="写出javascript运行结果"></a>写出javascript运行结果</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++)&#123;&#125; alert(i);</div></pre></td></tr></table></figure>
<p>在Es6之前js只有全局作用域和函数作用域，Es6中引入let从而能够产生块级作用域。for循环中用var关键字定义了变量i，并不会产生块级作用域也不满足函数作用域中定义变量的条件。故而“var i=0”在全局作用域中定义了变量i并赋值为0。当循环结束后i=10，接着弹出弹出全局作用域中的i，也就是10。<br>ps: 如果用let定义i的话,alert(i)会抛出undefined异常</p>
<h2 id="Cookie、sessionStorage、localStorage的区别"><a href="#Cookie、sessionStorage、localStorage的区别" class="headerlink" title="Cookie、sessionStorage、localStorage的区别"></a>Cookie、sessionStorage、localStorage的区别</h2><p>Cookie早期用来存放用户的相关信息，例如用来判断用户是否登陆等等。一般由服务器进行生成，能够设置有效时间等；在与服务器通信时携带在http头中，大小在4kb左右。<br>sessionStorage和localStorage都是HTML5中加入的技术，两者的作用和cookie相同均用来保存数据到浏览器本地，两个Storage大小在5M左右。<br>localStorage将数据保存在浏览器本地，除非手动清除否则将会永久存在；<br>sessionStorage用来保存会话中的数据，一旦会话结束那么数据也会被清除。<br>两者都仅仅在浏览器中保存数据，不会参与同服务器的通信。</p>
<h2 id="JSONP原理"><a href="#JSONP原理" class="headerlink" title="JSONP原理"></a>JSONP原理</h2><p>JSONP是JSON With Padding的简称。因为浏览器支持同源策略 —— 只有满足同源的脚本才会被执行，所谓同源就是域名、协议和端口都相同。而我们有的时候会将脚本放置在不同的服务器，这时就需要进行Js的跨域。JSONP就是利用“script”标签不受同源策略的限制来进行跨域的，通过javascript callback的形式进行单项跨域跨域访问。<a href="http://www.cnblogs.com/chopper/archive/2012/03/24/2403945.html" target="_blank" rel="external">欲知详情，请点这里。</a></p>
<h2 id="简述css盒模型"><a href="#简述css盒模型" class="headerlink" title="简述css盒模型"></a>简述css盒模型</h2><p>css盒模型就是将每一个元素视为一个盒子，每个盒子具有外边距、内边距、边框等一系列属性，整个HTML页面由许许多多个盒子相互嵌套堆叠组成。</p>
<h2 id="说说get和post请求的区别"><a href="#说说get和post请求的区别" class="headerlink" title="说说get和post请求的区别"></a>说说get和post请求的区别</h2><ol>
<li>get会将请求的内容会体现在URL上，post通过request传递，所以相对来说post比get更安全</li>
<li>使用场景的不同，get适用于单纯的向服务器索取数据、post更倾向于向服务器提交数据</li>
<li>post在浏览器后退会重复提交，post不会</li>
</ol>
<h2 id="写出下面代码的运行结果"><a href="#写出下面代码的运行结果" class="headerlink" title="写出下面代码的运行结果"></a>写出下面代码的运行结果</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = &#123;<span class="attr">n</span>: <span class="number">1</span>&#125;  </div><div class="line"><span class="keyword">var</span> b = a;  </div><div class="line">a.x = a = &#123;<span class="attr">n</span>: <span class="number">2</span>&#125;  </div><div class="line"><span class="built_in">console</span>.log(a.x);  </div><div class="line"><span class="built_in">console</span>.log(b.x)</div></pre></td></tr></table></figure>
<p>这题应该考察的就是运算符的优先级吧，详情可以查看<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Operator_Precedence" target="_blank" rel="external">MDN</a>。变量a、b都指向{n:1}这个对象，由于成员访问”.”的优先级要高于赋值运算符“=”，所以优先执行”a.x = {n:2}”，{n:1}对象变成了{n:1,x:{n:2}};接着执行”a={n: 2}”将a重赋值。于是乎a成了一个新的对象，b任然指向最开始{n:1}对象。所以运行结果就是a.x为undefined，b.x为{n:1,x:{n:2}}。</p>
<h2 id="说说类的创建、继承和闭包。"><a href="#说说类的创建、继承和闭包。" class="headerlink" title="说说类的创建、继承和闭包。"></a>说说类的创建、继承和闭包。</h2><p>javascript的语法中是没有类这个概念的，但是我们可以利用原型将类模拟出来。</p>
<h3 id="类的创建"><a href="#类的创建" class="headerlink" title="类的创建"></a>类的创建</h3><p>在ES6之前，利用函数原型实现类，通过构造函数对类进行模拟。函数内部使用this关键字指代实例对象，同时也可以将属性和方法定义在构造函数的prototype对象上。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//cat的构造函数 </span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Cat</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = name</div><div class="line">&#125;</div><div class="line"><span class="comment">//将猫叫函数定义在prototype对象上</span></div><div class="line">Cat.prototype.mew = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  alert(<span class="string">"喵喵喵"</span>)</div><div class="line">&#125;</div><div class="line"><span class="comment">//生成实例</span></div><div class="line"><span class="keyword">let</span> cat1 = <span class="keyword">new</span> Cat(<span class="string">"薛定谔的猫"</span>);</div><div class="line"><span class="built_in">console</span>.log(cat1.name)</div><div class="line">cat1.mew()</div></pre></td></tr></table></figure></p>
<blockquote>
<p>详情🔎阅读阮一峰老师的<a href="http://www.ruanyifeng.com/blog/2012/07/three_ways_to_define_a_javascript_class.html" target="_blank" rel="external">Javascript定义类（class）的三种方法</a></p>
</blockquote>
<p>Es2015中新增了类语法，可以通过class 关键字对类进行定义。其实质上是函数原型实现类的语法糖，原本的构造函数被constructor代替，定义在prototype中的方法则可以直接定义在class内。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(family, specie, hue) &#123;</div><div class="line">    <span class="keyword">this</span>.family = family</div><div class="line">    <span class="keyword">this</span>.specie = specie</div><div class="line">    <span class="keyword">this</span>.hue = hue</div><div class="line">  &#125;</div><div class="line">  yell() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.hue)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="类的继承"><a href="#类的继承" class="headerlink" title="类的继承"></a>类的继承</h3><p>类的继承有构造函数绑定继承，使用cell或apply方法将父对象的构造方法绑定到子对象实现继承。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 动物对象的构造函数</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">this</span>.species = <span class="string">"动物"</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">// cat继承animal</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Cat</span> (<span class="params">color, name</span>)</span>&#123;</div><div class="line">  Animal.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>)</div><div class="line">  <span class="keyword">this</span>.color = color</div><div class="line">  <span class="keyword">this</span>.name = name</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>prototype继承,Cat的prototype对象指向一个Animal实例。那么所有Cat实例都能继承Animal了。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//封装的继承方法</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">extend</span>(<span class="params">child, parent</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> F = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">  F.prototype = parent.prototype</div><div class="line">  child.prototype = <span class="keyword">new</span> F()</div><div class="line">  child.prototype.constructor = child</div><div class="line">  child.uber = parent.prototype</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>拷贝继承，我们换个思路，如果讲父对象的所有属性和方法也拷贝到子对象上不也是一种继承嘛。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">copy_extent</span>(<span class="params">child, parent</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> c = child.prototype</div><div class="line">  <span class="keyword">var</span> p = parent.prototype</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> p)&#123;</div><div class="line">    <span class="comment">//讲parent.prototype的对象一一拷贝到child.prototype中</span></div><div class="line">    c[i] = p[i]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>参考了阮老师的<a href="http://www.ruanyifeng.com/blog/2010/05/object-oriented_javascript_inheritance.html" target="_blank" rel="external">javascript面向对象编程（二）</a></p>
</blockquote>
<p>在Es6中类继承的方法就要简单许多，通过extends关键字就可实现类的继承。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Monkey</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>()&#123;</div><div class="line">    <span class="comment">//调用Animal的构造函数</span></div><div class="line">    <span class="keyword">super</span>()</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> hz = <span class="keyword">new</span> Monkey()</div><div class="line"><span class="built_in">console</span>.log(hz.species)  <span class="comment">//动物</span></div></pre></td></tr></table></figure></p>
<h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><p>javascript中当一个对象的引用被全部解除后，该对象就会被回收。内部作用域中的变量在方法执行完成，引用全部解除后被销毁从而导致外部作用域无法对其进行访问。通过闭包能将变量始终保持被引用的状态，实现外部变量对内部变量的永久访问；与此同时闭包也会增加内存的开销。</p>
<h2 id="是否有设计过通用的组件？"><a href="#是否有设计过通用的组件？" class="headerlink" title="是否有设计过通用的组件？"></a>是否有设计过通用的组件？</h2><blockquote>
<p>请设计一个 Dialog（弹出层） / Suggestion（自动完成） / Slider（图片轮播） 等组件,你会提供什么接口？调用过程是怎样的？可能会遇到什么细节问题？</p>
</blockquote>
<p>这个不知道怎么讲啊，一脸萌比。</p>
<h2 id="一个页面从输入-URL-到页面加载完的过程中都发生了什么事情？"><a href="#一个页面从输入-URL-到页面加载完的过程中都发生了什么事情？" class="headerlink" title="一个页面从输入 URL 到页面加载完的过程中都发生了什么事情？"></a>一个页面从输入 URL 到页面加载完的过程中都发生了什么事情？</h2><p>这似乎是一个经典的面试题，在SF上找到了<a href="https://segmentfault.com/q/1010000000489803" target="_blank" rel="external">答案</a>。大致的流程就是DNS解析URL -&gt; 向服务器发送http请求 -&gt; 服务器进行一系列处理 -&gt; 服务器返回http响应 -&gt; 浏览器显示HTMl并请求获取嵌入在html中的资源。</p>
<h2 id="什么是-“use-strict”-使用它的好处和坏处是什么？"><a href="#什么是-“use-strict”-使用它的好处和坏处是什么？" class="headerlink" title="什么是 “use strict”? 使用它的好处和坏处是什么？"></a>什么是 “use strict”? 使用它的好处和坏处是什么？</h2><p>使用“use strict”能够使javascript进入(严格模式（strict mode）)[<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode]，“use" target="_blank" rel="external">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode]，“use</a> strict”能够使整个脚本文件或单一的函数进入严格模式。<br>优点</p>
<ul>
<li>消除Javascript语法中一些不合理、不严禁之处，减少怪异行为；</li>
<li>保证代码运行的安全</li>
<li>提高编译器效率、增加运行速度<br>缺点</li>
<li>浏览器兼容性问题，只有Chrome13后、IE10，11等之后才有支持。</li>
</ul>
<h1 id="阿里巴巴"><a href="#阿里巴巴" class="headerlink" title="阿里巴巴"></a>阿里巴巴</h1><h2 id="创建一个1-100的数组，按顺序递增"><a href="#创建一个1-100的数组，按顺序递增" class="headerlink" title="创建一个1-100的数组，按顺序递增"></a>创建一个1-100的数组，按顺序递增</h2><p>这个不难，但是想不到有什么优雅的代码能够实现。</p>
<h2 id="说说前端跨域的解决方式"><a href="#说说前端跨域的解决方式" class="headerlink" title="说说前端跨域的解决方式"></a>说说前端跨域的解决方式</h2><p>由于同源策略的限制，在非同源的情况下以下三种情况不能会受到限制。</p>
<ul>
<li>cookie、localstorage和indexDB无法读取</li>
<li>DOM无法访问</li>
<li>AJAX请求不能发送<h3 id="document-domain"><a href="#document-domain" class="headerlink" title="document.domain"></a>document.domain</h3>同源的网页能够共享cookie，但是一级域名相同，二级域名不同的网页则会收到同源策略的限时。浏览器允许通过设置document.domain来共享cookie，此外服务器设置cookie的时候指定一级域名，这样二级三级域名不用做任何设置就能访问。<h3 id="window-postMessage"><a href="#window-postMessage" class="headerlink" title="window.postMessage"></a>window.postMessage</h3>H5中引入一个新的API:跨文档通信API，这个API在window对象新增了一个postMessage方法，允许跨窗口通信，无论是否同源。能够实现对localstorage的跨域访问<h3 id="AJAX跨域"><a href="#AJAX跨域" class="headerlink" title="AJAX跨域"></a>AJAX跨域</h3>ajax有三种方法实现跨域访问：JSONP,WebSocket,CORS。<blockquote>
<p>参考:<a href="http://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html" target="_blank" rel="external">浏览器同源策略及其规避方法</a></p>
</blockquote>
</li>
</ul>
<h4 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h4><p>JSONP就是通过在插入一个”script”元素，向服务器请求JSON数据，script不受同源策略的限制；服务器收到后将数据放在一个指定名字的回调函数中传回来。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addScriptTag</span>(<span class="params">src</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>)</div><div class="line">  script.src = src</div><div class="line">  <span class="built_in">document</span>.body.appendChild(script)</div><div class="line">&#125;</div><div class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  addScriptTag(<span class="string">'http://example.com/ip?callback=foo'</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">result</span>)</span>&#123;</div><div class="line">	<span class="comment">//result就是服务器返回的数据</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h4><p>一种通信协议，使用ws://(非加密),wss://(加密)作为协议前缀。此协议不实行同源策略，只要服务器支持就能进行跨域通信。</p>
<h3 id="CORS-跨源资源分享（Cross-Origin-Resource-Sharing）"><a href="#CORS-跨源资源分享（Cross-Origin-Resource-Sharing）" class="headerlink" title="CORS - 跨源资源分享（Cross-Origin Resource Sharing）"></a>CORS - 跨源资源分享（Cross-Origin Resource Sharing）</h3><blockquote>
<p>它允许浏览器向跨源服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。</p>
</blockquote>
<h2 id="JavaScript实现继承的常用方法有哪些？你推荐的是哪一种？"><a href="#JavaScript实现继承的常用方法有哪些？你推荐的是哪一种？" class="headerlink" title="JavaScript实现继承的常用方法有哪些？你推荐的是哪一种？"></a>JavaScript实现继承的常用方法有哪些？你推荐的是哪一种？</h2><p>JavaScript常用的实现继承的方法有下面几种：</p>
<ol>
<li>原型链实现继承</li>
<li>借用构造函数式继承</li>
<li>组合式继承</li>
<li>原型式继承</li>
<li>寄生式继承</li>
<li>寄生组合式继承<br>相对来说，组合式继承和寄生组合式继承来的更加推荐，在这两者中后者优于前者。其他的几种继承实现方式或多或少都有些许存在的问题。<h2 id="在项目开发完成之后，根据雅虎性能优化规则，需要对html，JS，CSS，图片需要做出怎样的处理？是否可以借助构建工具实现自动化？"><a href="#在项目开发完成之后，根据雅虎性能优化规则，需要对html，JS，CSS，图片需要做出怎样的处理？是否可以借助构建工具实现自动化？" class="headerlink" title="在项目开发完成之后，根据雅虎性能优化规则，需要对html，JS，CSS，图片需要做出怎样的处理？是否可以借助构建工具实现自动化？"></a>在项目开发完成之后，根据雅虎性能优化规则，需要对html，JS，CSS，图片需要做出怎样的处理？是否可以借助构建工具实现自动化？</h2><a href="https://developer.yahoo.com/performance/rules.html" target="_blank" rel="external">雅虎优化规则</a>.<br>大致需要做如下处理：<h3 id="减少Http请求"><a href="#减少Http请求" class="headerlink" title="减少Http请求"></a>减少Http请求</h3></li>
</ol>
<ul>
<li>合并脚本和样式表</li>
<li>Css Sprites</li>
<li>区分主次，分层加载<h3 id="减少请求带宽"><a href="#减少请求带宽" class="headerlink" title="减少请求带宽"></a>减少请求带宽</h3></li>
<li>开启GZip</li>
<li>最小化js脚本和css样式表</li>
<li>移除重复的脚本</li>
<li>图像优化<h3 id="页面结构"><a href="#页面结构" class="headerlink" title="页面结构"></a>页面结构</h3>样式表放在顶部，脚本位于底部。尽早刷新内容，避免空白等待。<br>脚本和样式表的合并以及最小化、图像优化等都可以借助webpackage或是gulp等构建工具实现，例如通过postcss配合autoprefixer, cssnano插件可以对样式表进行浏览器私有前缀补全以及压缩最小化等操作；<h2 id="说说前端中的事件流？"><a href="#说说前端中的事件流？" class="headerlink" title="说说前端中的事件流？"></a>说说前端中的事件流？</h2>前端事件流分为3个部分，即 事件捕获阶段、处于目标阶段、事件冒泡阶段。<br>当一个DOM事件被触发的时候，它并不是简单的直接从目标上触发，而是会经历以上三个阶段。<br>DOM事件被触发，首先从文档的根节点流向目标节点（捕获阶段）；然后到达目标节点，触发事件（目标阶段）；最后再回溯到文档的根节点（冒泡阶段）。<br>在冒泡阶段我们可以对元素进行事件委托而不必为每一个元素绑定事件，例如对ul下的li进行事件委托。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ulDom.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">  e = <span class="built_in">window</span>.e || e</div><div class="line">  <span class="keyword">if</span> ( e.target.nodeName.toUpperCase() === <span class="string">'LI'</span> ) &#123;</div><div class="line">    <span class="comment">//.....</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<p>如果对mouseover以及mouseout使用事件代理的时候，li下面还有子元素，就会发生一些坑爹的事情。比如从li移入子元素会触发mouseout，从子元素移入li会触发mouseover，我们在进行操作之前需要对元素的parent进行判断，过滤掉一些不需要操作的情况。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">ulDom.addEventListener(<span class="string">'mouseover'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">  e = <span class="built_in">window</span>.e || e</div><div class="line">  <span class="keyword">let</span> s = e.fromElement || e.relatedTraget</div><div class="line">  <span class="comment">//判断s是否为当前元素的父元素</span></div><div class="line">  <span class="keyword">let</span> reg = <span class="keyword">this</span>.compareDocumentPosition(s);</div><div class="line">  <span class="comment">// IE 下使用 this.contains(s) 来判断，其返回值为true和false</span></div><div class="line">  <span class="keyword">if</span> (!(reg == <span class="number">20</span> || reg == <span class="number">0</span>)) &#123;</div><div class="line">    <span class="comment">//不是父元素就执行操作...</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="JS-中的原型链是什么？"><a href="#JS-中的原型链是什么？" class="headerlink" title="JS 中的原型链是什么？"></a>JS 中的原型链是什么？</h2><p>JS中，每创建一个函数都会有一个原型（prototype）对象，原型对象中有一个constrictor属性指向其自身。每个对象都有一个隐式原型[[prototype]]（部分浏览器将其实现为<strong>proto</strong>）,[[prototype]]指向创建这个对象的函数的prototype，从而构成原型链。<br>InstanceOf用来判断一个对象是否是一个函数的引用，也就是判断属性是自身的还是从原型链上继承而来的。<br>原型链还能用来模拟类的继承等</p>
<h2 id="有一个长度为100的数组，请以优雅的方式求出该数组的前10个元素之和"><a href="#有一个长度为100的数组，请以优雅的方式求出该数组的前10个元素之和" class="headerlink" title="有一个长度为100的数组，请以优雅的方式求出该数组的前10个元素之和"></a>有一个长度为100的数组，请以优雅的方式求出该数组的前10个元素之和</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSum</span>(<span class="params">arr</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> arr.splice(<span class="number">0</span>,<span class="number">10</span>).reduce(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> a + b</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="了解过flex布局吗？说说它和传统布局的有何不同？"><a href="#了解过flex布局吗？说说它和传统布局的有何不同？" class="headerlink" title="了解过flex布局吗？说说它和传统布局的有何不同？"></a>了解过flex布局吗？说说它和传统布局的有何不同？</h2><h2 id="移动端的图片优化实践方式有哪些？"><a href="#移动端的图片优化实践方式有哪些？" class="headerlink" title="移动端的图片优化实践方式有哪些？"></a>移动端的图片优化实践方式有哪些？</h2><p>这个我母鸡啊，下面凭感觉<br>移动端使用rem作为图片的大小单位；<br>图片格式方面采用WebP，对不支持的浏览器进行适配；<br>根据不同的网络环境，加载不同质量的图片；</p>
<h2 id="请编写一个JavaScript函数-parseQueryString，它的用途是把URL参数解析为一个对象"><a href="#请编写一个JavaScript函数-parseQueryString，它的用途是把URL参数解析为一个对象" class="headerlink" title="请编写一个JavaScript函数 parseQueryString，它的用途是把URL参数解析为一个对象"></a>请编写一个JavaScript函数 parseQueryString，它的用途是把URL参数解析为一个对象</h2><p>利用a标签配合正则表达式将URL进行解析<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseUrl</span>(<span class="params">url</span>)</span>&#123;</div><div class="line">  url = url || <span class="string">'http://abc.com:8080/dir/index.html?id=255&amp;m=hello#top'</span></div><div class="line">  <span class="keyword">let</span> a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>)</div><div class="line">  a.href = url </div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">source</span>: url,</div><div class="line">    <span class="attr">protocol</span>: a.protocol.replace(<span class="string">':'</span>,<span class="string">''</span>),</div><div class="line">    <span class="attr">host</span>: a.hostname,</div><div class="line">    <span class="attr">port</span>: a.port,</div><div class="line">    <span class="attr">query</span>: a.search,</div><div class="line">    <span class="attr">prams</span>: (<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="keyword">let</span> query = a.search.replace(<span class="regexp">/^\?/</span>, <span class="string">''</span>).split(<span class="string">'&amp;'</span>), </div><div class="line">          result = &#123;&#125;,</div><div class="line">          len = query.length,</div><div class="line">          temp = []</div><div class="line">          i = <span class="number">0</span></div><div class="line">      <span class="keyword">for</span>(; i&lt;len; i++) &#123;</div><div class="line">        <span class="keyword">if</span> (!query[i])&#123;</div><div class="line">          <span class="keyword">continue</span></div><div class="line">        &#125;</div><div class="line">        <span class="built_in">console</span>.log(temp)</div><div class="line">        temp = query[i].split(<span class="string">'='</span>)</div><div class="line">        result[temp[<span class="number">0</span>]] = temp[<span class="number">1</span>]</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">return</span> result</div><div class="line">    &#125;)(),</div><div class="line">    <span class="attr">file</span>: (a.pathname.match(<span class="regexp">/([^/?#]+)$/i</span>) || [,<span class="string">''</span>])[<span class="number">1</span>],</div><div class="line">    <span class="attr">hash</span>: a.hash.replace(<span class="string">'#'</span>,<span class="string">''</span>),</div><div class="line">    <span class="attr">path</span>: a.pathname.replace(<span class="regexp">/^([^/])/</span>,<span class="string">'/$1'</span>),</div><div class="line">    <span class="attr">relative</span>: (a.href.match(<span class="regexp">/tps?:\/[^/]+(.+)/</span>) || [,<span class="string">''</span>])[<span class="number">1</span>],</div><div class="line">    <span class="attr">segments</span>: a.pathname.replace(<span class="regexp">/^\//</span>,<span class="string">''</span>).split(<span class="string">'/'</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(parseUrl())</div></pre></td></tr></table></figure></p>
<h2 id="xss和csrf分别是什么？"><a href="#xss和csrf分别是什么？" class="headerlink" title="xss和csrf分别是什么？"></a>xss和csrf分别是什么？</h2><p>XSS是网站注入攻击的一种，是实现SCRF诸多方式中的一种。<br>XSS也就是跨站脚本攻击,本质是HTML注入，通过输入特殊的内容，让服务器端识别为指令进行执行。<br>CSRF是伪造请求，冒充用户在站内的正常操作。</p>
<h2 id="说说前端如何解决异步回调地狱？"><a href="#说说前端如何解决异步回调地狱？" class="headerlink" title="说说前端如何解决异步回调地狱？"></a>说说前端如何解决异步回调地狱？</h2><p>使用Promise、引入Anync辅助库、ES6-Generator</p>
<h2 id="淘宝那里的商品项，如图片，滚动到了才加载，你知道怎么实现么"><a href="#淘宝那里的商品项，如图片，滚动到了才加载，你知道怎么实现么" class="headerlink" title="淘宝那里的商品项，如图片，滚动到了才加载，你知道怎么实现么"></a>淘宝那里的商品项，如图片，滚动到了才加载，你知道怎么实现么</h2><p>懒加载，首先加载首屏的内容。当用户往下滚动，有需求的时候在对剩下的模块进行初始化。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="辣鸡Coder" />
          <p class="site-author-name" itemprop="name">辣鸡Coder</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">17</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">辣鸡Coder</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	




  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("wsvVY4eXXKHmlsec5tCzMGm7-gzGzoHsz", "sv9Metx0eHoTNsJY8uEo8jLP");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


</body>
</html>
